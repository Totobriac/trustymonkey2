{"remainingRequest":"/home/pi/Desktop/last_version/trustymonkey/trusty_monkey/frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/pi/Desktop/last_version/trustymonkey/trusty_monkey/frontend/src/components/ReviewEditor.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/pi/Desktop/last_version/trustymonkey/trusty_monkey/frontend/src/components/ReviewEditor.vue","mtime":1602406537065},{"path":"/home/pi/Desktop/last_version/trustymonkey/trusty_monkey/frontend/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/pi/Desktop/last_version/trustymonkey/trusty_monkey/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/pi/Desktop/last_version/trustymonkey/trusty_monkey/frontend/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IHN0b3JlIH0gZnJvbSAiLi4vY29tbW9uL3N0b3JlLmpzIgppbXBvcnQgYXhpb3MgZnJvbSAnYXhpb3MnCmltcG9ydCB7IENTUkZfVE9LRU4gfSBmcm9tICIuLi9jb21tb24vY3NyZl90b2tlbi5qcyIKaW1wb3J0IFBpY3R1cmVVcGxvYWQgZnJvbSAiQC9jb21wb25lbnRzL1BpY3R1cmVVcGxvYWQudnVlIjsKaW1wb3J0IFJlc2l6ZSBmcm9tICJAL2NvbXBvbmVudHMvUmVzaXplLnZ1ZSIKCmltcG9ydCB2dWVjb25maWcgZnJvbSAiLi4vdnVlY29uZmlnLmpzIjsKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiUmV2aWV3RWRpdG9yIiwKICBjb21wdXRlZDp7CiAgICBzdG9yZVN0YXRlKCl7CiAgICAgIHJldHVybiBzdG9yZS5zdGF0ZTsKICAgfQogIH0sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGVycm9yOiBudWxsLAogICAgICBzZWxlY3RlZEZpbGU6IG51bGwsCiAgICAgIHVwVXJsOiBudWxsLAogICAgICB1cFVybEFycmF5OiBbXSwgICAgICAKICAgICAgZW5kcG9pbnQ6IG51bGwsICAgICAgCiAgICAgIG5ld1BpY3R1cmVVcmw6IG51bGwsICAgICAgICAgICAgCiAgICAgIGJ1dHRvblBpY3M6IFsnRW50csOpZScsICdQbGF0LXByaW5jaXBhbCcsCiAgICAgICAgICAgICAgICAgICdEZXNzZXJ0JywgJ01lbnUnLCAnRXh0w6lyaWV1cicsCiAgICAgICAgICAgICAgICAgICdJbnTDqXJpZXVyJ10sICAgICAgCiAgICB9CiAgfSwKICBwcm9wczogewogICAgaWQ6IHsKICAgICAgdHlwZTogTnVtYmVyLAogICAgICByZXF1aXJlZDogdHJ1ZQogICAgfSwKICB9LCAgCiAgbWV0aG9kczogewogICAgb25VcGxvYWQoKSB7CiAgICAgIGNvbnNvbGUubG9nKHRoaXMudXBVcmxBcnJheSkKICAgICAgaWYgKHRoaXMuc3RvcmVTdGF0ZS5sYWJlbHMpIHsgCiAgICAgICAgdGhpcy5zZWxlY3RlZEZpbGUgPSB0aGlzLnN0b3JlU3RhdGUuZmlsZSAgICAgICAgICAgIAogICAgICAgIGNvbnN0IGZkID0gbmV3IEZvcm1EYXRhKCk7CiAgICAgICAgbGV0IGF4aW9zQ29uZmlnID0gewogICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAnWC1DU1JGVE9LRU4nOiBDU1JGX1RPS0VOLCAgICAgICAgICAgCiAgICAgICAgICB9CiAgICAgICAgfTsKCiAgICAgICAgaWYgKHRoaXMudXBVcmwgPT0gMCkgeyAgICAgICAgCiAgICAgICAgICBpZiAodGhpcy5zdG9yZVN0YXRlLmxhYmVscy5pbmNsdWRlcyAoJ0Zvb2QnKSkgewogICAgICAgICAgICAgICAgdGhpcy5lbmRwb2ludCA9ICJzdGFydGVyX3BpYyIgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB0aGlzLnN0b3JlU3RhdGUudXBFcnJvciA9IG51bGx9CiAgICAgICAgICAgICAgZWxzZSB7c3RvcmUuc2V0VXBFcnJvcigiQ2VjaSBuJ2VzdCBwYXMgbGEgcGhvdG8gZCd1bmUgZW50csOpZSIpLCAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgdGhpcy5lbmRwb2ludCA9IGZhbHNlLAogICAgICAgICAgICAgICAgICAgIHN0b3JlLnNldFNob3dDYXRCdXQoKX0KICAgICAgICB9IGVsc2UgaWYgKHRoaXMudXBVcmwgPT0gMSkgewogICAgICAgICAgaWYgKHRoaXMuc3RvcmVTdGF0ZS5sYWJlbHMuaW5jbHVkZXMgKCdGb29kJykpIHsKICAgICAgICAgICAgICAgIHRoaXMuZW5kcG9pbnQgPSAibWFpbl9waWMiICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgdGhpcy5zdG9yZVN0YXRlLnVwRXJyb3IgPSBudWxsfQogICAgICAgICAgICAgIGVsc2Uge3N0b3JlLnNldFVwRXJyb3IoIkNlY2kgbidlc3QgcGFzIGxhIHBob3RvIGQndW4gcGxhdCIpLCAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgdGhpcy5lbmRwb2ludCA9IGZhbHNlLAogICAgICAgICAgICAgICAgICAgIHN0b3JlLnNldFNob3dDYXRCdXQoKX0KICAgICAgICB9IGVsc2UgaWYgKHRoaXMudXBVcmwgPT0gMikgeyAgICAgICAgICAKICAgICAgICAgICAgICBpZiAodGhpcy5zdG9yZVN0YXRlLmxhYmVscy5pbmNsdWRlcyAoJ0Rlc3NlcnQnKSkgewogICAgICAgICAgICAgICAgdGhpcy5lbmRwb2ludCA9ICJkZXNzZXJ0X3BpYyIgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB0aGlzLnN0b3JlU3RhdGUudXBFcnJvciA9IG51bGx9CiAgICAgICAgICAgICAgZWxzZSB7c3RvcmUuc2V0VXBFcnJvcigiQ2VjaSBuJ2VzdCBwYXMgbGEgcGhvdG8gZCd1biBkZXNzZXJ0IiksICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICB0aGlzLmVuZHBvaW50ID0gZmFsc2UsCiAgICAgICAgICAgICAgICAgICAgc3RvcmUuc2V0U2hvd0NhdEJ1dCgpfQogICAgICAgIH0gZWxzZSBpZiAodGhpcy51cFVybCA9PSAzKSB7ICAgICAgICAgIAogICAgICAgICAgICAgIGlmICh0aGlzLnN0b3JlU3RhdGUubGFiZWxzLmluY2x1ZGVzICgnVGV4dCcpKSB7CiAgICAgICAgICAgICAgICB0aGlzLmVuZHBvaW50ID0gIm1lbnVfcGljIiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIHRoaXMuc3RvcmVTdGF0ZS51cEVycm9yID0gbnVsbH0KICAgICAgICAgICAgICBlbHNlIHtzdG9yZS5zZXRVcEVycm9yKCJDZWNpIG4nZXN0IHBhcyBsYSBwaG90byBkJ3VuIG1lbnUiKSwgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIHRoaXMuZW5kcG9pbnQgPSBmYWxzZSwKICAgICAgICAgICAgICAgICAgICBzdG9yZS5zZXRTaG93Q2F0QnV0KCl9CiAgICAgICAgfSBlbHNlIGlmICh0aGlzLnVwVXJsID09IDQpIHsKICAgICAgICAgIGlmICh0aGlzLnN0b3JlU3RhdGUubGFiZWxzLmluY2x1ZGVzICgnQnVpbGRpbmcnKSkgewogICAgICAgICAgICAgICAgdGhpcy5lbmRwb2ludCA9ICJvdXRzaWRlX3BpYyIgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB0aGlzLnN0b3JlU3RhdGUudXBFcnJvciA9IG51bGx9CiAgICAgICAgICAgICAgZWxzZSB7c3RvcmUuc2V0VXBFcnJvcigiQ2VjaSBuJ2VzdCBwYXMgdW5lIHBob3RvIGRlIGwnZXh0w6lyaWV1ciBkdSByZXN0YXVyYW50IiksICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICB0aGlzLmVuZHBvaW50ID0gZmFsc2UsCiAgICAgICAgICAgICAgICAgICAgc3RvcmUuc2V0U2hvd0NhdEJ1dCgpfQogICAgICAgIH0gZWxzZSBpZiAodGhpcy51cFVybCA9PSA1KSB7CiAgICAgICAgICBpZiAodGhpcy5zdG9yZVN0YXRlLmxhYmVscy5pbmNsdWRlcyAoJ1Jlc3RhdXJhbnQnKSkgewogICAgICAgICAgICAgICAgdGhpcy5lbmRwb2ludCA9ICJpbnNpZGVfcGljIiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIHRoaXMuc3RvcmVTdGF0ZS51cEVycm9yID0gbnVsbH0KICAgICAgICAgICAgICBlbHNlIHtzdG9yZS5zZXRVcEVycm9yKCJDZWNpIG4nZXN0IHBhcyB1bmUgcGhvdG8gZGUgbCdpbnRlcmlldXIgZHUgcmVzdGF1cmFudCIpLCAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgdGhpcy5lbmRwb2ludCA9IGZhbHNlLAogICAgICAgICAgICAgICAgICAgIHN0b3JlLnNldFNob3dDYXRCdXQoKX0KICAgICAgICB9IAogICAgICAgIAogICAgICAgIGlmICh0aGlzLmVuZHBvaW50ICE9IGZhbHNlKXsKICAgICAgICAgIGNvbnNvbGUubG9nKHRoaXMuZW5kcG9pbnQpCiAgICAgICAgICBmZC5hcHBlbmQoJ3BpY3R1cmVfMScsIHRoaXMuc2VsZWN0ZWRGaWxlKQogICAgICAgICAgZmQuYXBwZW5kKCdyZXN0YXVyYW50X3JldmlldycsIHRoaXMuaWQpCiAgICAgICAgICBheGlvcy5wb3N0KGAke3Z1ZWNvbmZpZy5iYXNlVXJsfS9hcGkvJHt0aGlzLmVuZHBvaW50fS9gLCBmZCwgYXhpb3NDb25maWcpCiAgICAgICAgICAgIC50aGVuKHJlcyA9PiB7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgIHRoaXMudXBVcmwgPSBudWxsICAgICAgICAgICAgICAKICAgICAgICAgICAgICBzdG9yZS5zZXRTaG93Q2F0QnV0KCkgICAgICAgICAgICAgIAogICAgICAgICAgICAgIGxldCBuZXdQaWN0dXJlVXJsID0gcmVzLmRhdGEucGljdHVyZV8xCiAgICAgICAgICAgICAgbGV0IG5ld1BpY3R1cmVJZCA9IHJlcy5kYXRhLmlkCiAgICAgICAgICAgICAgbGV0IGFwaVVSTCA9IHJlcy5jb25maWcudXJsCiAgICAgICAgICAgICAgbGV0IGFkZFBpY0RpYyA9IHsidXJsIjogbmV3UGljdHVyZVVybCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImlkIjogbmV3UGljdHVyZUlkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiYXBpVXJsIjogYXBpVVJMICB9ICAgICAgICAgIAogICAgICAgICAgICAgIHN0b3JlLmFkZFBpY3R1cmUoYWRkUGljRGljKSAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgIH0pCiAgICAgICAgfQogICAgICB9IAogICAgfSwKICAgIGdvSG9tZSgpIHsKICAgICAgdGhpcy4kcm91dGVyLnB1c2goe25hbWU6ICdob21lJ30pICAgICAgICAgICAKICAgIH0sCiAgICBzZXRVcFVybCgpIHsKICAgICAgdGhpcy51cFVybEFycmF5LnB1c2godGhpcy51cGV4KQogICAgICBpZiAodGhpcy51cFVybEFycmF5Lmxlbmd0aCA+IDEgJiYgdGhpcy51cFVybEFycmF5Lmxlbmd0aCAlIDIgPT0gMCkgewogICAgICAgIHRoaXMudXBVcmwgPSB0aGlzLnVwVXJsQXJyYXlbdGhpcy51cFVybEFycmF5Lmxlbmd0aCAtIDJdCiAgICAgICAgY29uc29sZS5sb2codGhpcy51cFVybCkKICAgICAgICBzdG9yZS5zZXRTaG93Q2F0QnV0KCkKICAgICAgICB0aGlzLnN0b3JlU3RhdGUudXBFcnJvciA9IG51bGwKICAgICAgfQogICAgfSAgIAogIH0sIAogIGNvbXBvbmVudHM6IHsKICAgIFBpY3R1cmVVcGxvYWQsCiAgICBSZXNpemUKICAgIH0sCiAgd2F0Y2g6IHsKICAgICJzdG9yZVN0YXRlLmxhYmVscyI6IGZ1bmN0aW9uICgpIHsKICAgICAgdGhpcy5vblVwbG9hZCgpCiAgICAgIH0gCiAgICB9IAogIH0K"},{"version":3,"sources":["ReviewEditor.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyCA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ReviewEditor.vue","sourceRoot":"src/components","sourcesContent":["<template>\n<div class=\"editor\">\n\n  <div>\n    <PictureUpload/>    \n    <hr/>\n  </div>\n\n  <div>\n\n  <div class=\"container text-center\" v-show=\"this.storeState.preLoader\">\n    <div>\n      <img src=\"https://media.giphy.com/media/pFwRzOLfuGHok/giphy.gif\" class=\"w-25\">\n    </div>   \n  </div> \n\n  <div v-show=\"this.storeState.showCatBut == true\">\n    <div class=\"btnRow d-flex flex-row justify-content-around\">\n      <div class=\"mt-3\" v-for=\"(buttonPic, index) in buttonPics\" :key=\"buttonPic\">\n\n        <label for=\"fileInput\" @click=\"upex=index, setUpUrl()\"\n              class=\"catBtn border border-success rounded p-2\"\n        >{{ buttonPic }} <Resize/> </label>\n      </div>\n    </div>\n  </div>\n\n  <div class=\"d-flex flex-row \">      \n        <button class=\"btn btn-success btn-sm m-3 \" \n                @click=\"goHome\">Soumettre</button>\n        <div v-show=\"this.storeState.upError != null\"\n              class=\"container border border-danger rounded w-50 h-50 m-auto text-center\">\n          <p  class=\"text-danger my-auto\">{{ this.storeState.upError }}</p>\n        </div>\n  </div>  \n\n  </div>\n</div> \n</template>\n\n<script>\nimport { store } from \"../common/store.js\"\nimport axios from 'axios'\nimport { CSRF_TOKEN } from \"../common/csrf_token.js\"\nimport PictureUpload from \"@/components/PictureUpload.vue\";\nimport Resize from \"@/components/Resize.vue\"\n\nimport vueconfig from \"../vueconfig.js\";\n\nexport default {\n  name: \"ReviewEditor\",\n  computed:{\n    storeState(){\n      return store.state;\n   }\n  },\n  data() {\n    return {\n      error: null,\n      selectedFile: null,\n      upUrl: null,\n      upUrlArray: [],      \n      endpoint: null,      \n      newPictureUrl: null,            \n      buttonPics: ['Entrée', 'Plat-principal',\n                  'Dessert', 'Menu', 'Extérieur',\n                  'Intérieur'],      \n    }\n  },\n  props: {\n    id: {\n      type: Number,\n      required: true\n    },\n  },  \n  methods: {\n    onUpload() {\n      console.log(this.upUrlArray)\n      if (this.storeState.labels) { \n        this.selectedFile = this.storeState.file            \n        const fd = new FormData();\n        let axiosConfig = {\n          headers: {\n            'X-CSRFTOKEN': CSRF_TOKEN,           \n          }\n        };\n\n        if (this.upUrl == 0) {        \n          if (this.storeState.labels.includes ('Food')) {\n                this.endpoint = \"starter_pic\"                \n                this.storeState.upError = null}\n              else {store.setUpError(\"Ceci n'est pas la photo d'une entrée\"),                    \n                    this.endpoint = false,\n                    store.setShowCatBut()}\n        } else if (this.upUrl == 1) {\n          if (this.storeState.labels.includes ('Food')) {\n                this.endpoint = \"main_pic\"                \n                this.storeState.upError = null}\n              else {store.setUpError(\"Ceci n'est pas la photo d'un plat\"),                    \n                    this.endpoint = false,\n                    store.setShowCatBut()}\n        } else if (this.upUrl == 2) {          \n              if (this.storeState.labels.includes ('Dessert')) {\n                this.endpoint = \"dessert_pic\"                \n                this.storeState.upError = null}\n              else {store.setUpError(\"Ceci n'est pas la photo d'un dessert\"),                    \n                    this.endpoint = false,\n                    store.setShowCatBut()}\n        } else if (this.upUrl == 3) {          \n              if (this.storeState.labels.includes ('Text')) {\n                this.endpoint = \"menu_pic\"                \n                this.storeState.upError = null}\n              else {store.setUpError(\"Ceci n'est pas la photo d'un menu\"),                    \n                    this.endpoint = false,\n                    store.setShowCatBut()}\n        } else if (this.upUrl == 4) {\n          if (this.storeState.labels.includes ('Building')) {\n                this.endpoint = \"outside_pic\"                \n                this.storeState.upError = null}\n              else {store.setUpError(\"Ceci n'est pas une photo de l'extérieur du restaurant\"),                    \n                    this.endpoint = false,\n                    store.setShowCatBut()}\n        } else if (this.upUrl == 5) {\n          if (this.storeState.labels.includes ('Restaurant')) {\n                this.endpoint = \"inside_pic\"                \n                this.storeState.upError = null}\n              else {store.setUpError(\"Ceci n'est pas une photo de l'interieur du restaurant\"),                    \n                    this.endpoint = false,\n                    store.setShowCatBut()}\n        } \n        \n        if (this.endpoint != false){\n          console.log(this.endpoint)\n          fd.append('picture_1', this.selectedFile)\n          fd.append('restaurant_review', this.id)\n          axios.post(`${vueconfig.baseUrl}/api/${this.endpoint}/`, fd, axiosConfig)\n            .then(res => {                                  \n              this.upUrl = null              \n              store.setShowCatBut()              \n              let newPictureUrl = res.data.picture_1\n              let newPictureId = res.data.id\n              let apiURL = res.config.url\n              let addPicDic = {\"url\": newPictureUrl,\n                              \"id\": newPictureId,\n                              \"apiUrl\": apiURL  }          \n              store.addPicture(addPicDic)                            \n          })\n        }\n      } \n    },\n    goHome() {\n      this.$router.push({name: 'home'})           \n    },\n    setUpUrl() {\n      this.upUrlArray.push(this.upex)\n      if (this.upUrlArray.length > 1 && this.upUrlArray.length % 2 == 0) {\n        this.upUrl = this.upUrlArray[this.upUrlArray.length - 2]\n        console.log(this.upUrl)\n        store.setShowCatBut()\n        this.storeState.upError = null\n      }\n    }   \n  }, \n  components: {\n    PictureUpload,\n    Resize\n    },\n  watch: {\n    \"storeState.labels\": function () {\n      this.onUpload()\n      } \n    } \n  }\n</script>\n\n<style>\n.editor {\n  background-color: white;\n  border: 1px solid \n}\n.custom-file-label {\n  background-color: rgb(234, 236, 122);\n}\n.btnRow {\n  background-color: white\n}\n.catBtn:hover {\n  background-color: #5cb85c;\n  color: white\n}\n</style>"]}]}