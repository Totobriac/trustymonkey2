{"remainingRequest":"/home/pi/Desktop/last_version/trustymonkey/trusty_monkey/frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/pi/Desktop/last_version/trustymonkey/trusty_monkey/frontend/src/components/ReviewEditor.vue?vue&type=style&index=0&lang=css&","dependencies":[{"path":"/home/pi/Desktop/last_version/trustymonkey/trusty_monkey/frontend/src/components/ReviewEditor.vue","mtime":1602406537065},{"path":"/home/pi/Desktop/last_version/trustymonkey/trusty_monkey/frontend/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/pi/Desktop/last_version/trustymonkey/trusty_monkey/frontend/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/home/pi/Desktop/last_version/trustymonkey/trusty_monkey/frontend/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/home/pi/Desktop/last_version/trustymonkey/trusty_monkey/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/pi/Desktop/last_version/trustymonkey/trusty_monkey/frontend/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgouZWRpdG9yIHsKICBiYWNrZ3JvdW5kLWNvbG9yOiB3aGl0ZTsKICBib3JkZXI6IDFweCBzb2xpZCAKfQouY3VzdG9tLWZpbGUtbGFiZWwgewogIGJhY2tncm91bmQtY29sb3I6IHJnYigyMzQsIDIzNiwgMTIyKTsKfQouYnRuUm93IHsKICBiYWNrZ3JvdW5kLWNvbG9yOiB3aGl0ZQp9Ci5jYXRCdG46aG92ZXIgewogIGJhY2tncm91bmQtY29sb3I6ICM1Y2I4NWM7CiAgY29sb3I6IHdoaXRlCn0K"},{"version":3,"sources":["ReviewEditor.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ReviewEditor.vue","sourceRoot":"src/components","sourcesContent":["<template>\n<div class=\"editor\">\n\n  <div>\n    <PictureUpload/>    \n    <hr/>\n  </div>\n\n  <div>\n\n  <div class=\"container text-center\" v-show=\"this.storeState.preLoader\">\n    <div>\n      <img src=\"https://media.giphy.com/media/pFwRzOLfuGHok/giphy.gif\" class=\"w-25\">\n    </div>   \n  </div> \n\n  <div v-show=\"this.storeState.showCatBut == true\">\n    <div class=\"btnRow d-flex flex-row justify-content-around\">\n      <div class=\"mt-3\" v-for=\"(buttonPic, index) in buttonPics\" :key=\"buttonPic\">\n\n        <label for=\"fileInput\" @click=\"upex=index, setUpUrl()\"\n              class=\"catBtn border border-success rounded p-2\"\n        >{{ buttonPic }} <Resize/> </label>\n      </div>\n    </div>\n  </div>\n\n  <div class=\"d-flex flex-row \">      \n        <button class=\"btn btn-success btn-sm m-3 \" \n                @click=\"goHome\">Soumettre</button>\n        <div v-show=\"this.storeState.upError != null\"\n              class=\"container border border-danger rounded w-50 h-50 m-auto text-center\">\n          <p  class=\"text-danger my-auto\">{{ this.storeState.upError }}</p>\n        </div>\n  </div>  \n\n  </div>\n</div> \n</template>\n\n<script>\nimport { store } from \"../common/store.js\"\nimport axios from 'axios'\nimport { CSRF_TOKEN } from \"../common/csrf_token.js\"\nimport PictureUpload from \"@/components/PictureUpload.vue\";\nimport Resize from \"@/components/Resize.vue\"\n\nimport vueconfig from \"../vueconfig.js\";\n\nexport default {\n  name: \"ReviewEditor\",\n  computed:{\n    storeState(){\n      return store.state;\n   }\n  },\n  data() {\n    return {\n      error: null,\n      selectedFile: null,\n      upUrl: null,\n      upUrlArray: [],      \n      endpoint: null,      \n      newPictureUrl: null,            \n      buttonPics: ['Entrée', 'Plat-principal',\n                  'Dessert', 'Menu', 'Extérieur',\n                  'Intérieur'],      \n    }\n  },\n  props: {\n    id: {\n      type: Number,\n      required: true\n    },\n  },  \n  methods: {\n    onUpload() {\n      console.log(this.upUrlArray)\n      if (this.storeState.labels) { \n        this.selectedFile = this.storeState.file            \n        const fd = new FormData();\n        let axiosConfig = {\n          headers: {\n            'X-CSRFTOKEN': CSRF_TOKEN,           \n          }\n        };\n\n        if (this.upUrl == 0) {        \n          if (this.storeState.labels.includes ('Food')) {\n                this.endpoint = \"starter_pic\"                \n                this.storeState.upError = null}\n              else {store.setUpError(\"Ceci n'est pas la photo d'une entrée\"),                    \n                    this.endpoint = false,\n                    store.setShowCatBut()}\n        } else if (this.upUrl == 1) {\n          if (this.storeState.labels.includes ('Food')) {\n                this.endpoint = \"main_pic\"                \n                this.storeState.upError = null}\n              else {store.setUpError(\"Ceci n'est pas la photo d'un plat\"),                    \n                    this.endpoint = false,\n                    store.setShowCatBut()}\n        } else if (this.upUrl == 2) {          \n              if (this.storeState.labels.includes ('Dessert')) {\n                this.endpoint = \"dessert_pic\"                \n                this.storeState.upError = null}\n              else {store.setUpError(\"Ceci n'est pas la photo d'un dessert\"),                    \n                    this.endpoint = false,\n                    store.setShowCatBut()}\n        } else if (this.upUrl == 3) {          \n              if (this.storeState.labels.includes ('Text')) {\n                this.endpoint = \"menu_pic\"                \n                this.storeState.upError = null}\n              else {store.setUpError(\"Ceci n'est pas la photo d'un menu\"),                    \n                    this.endpoint = false,\n                    store.setShowCatBut()}\n        } else if (this.upUrl == 4) {\n          if (this.storeState.labels.includes ('Building')) {\n                this.endpoint = \"outside_pic\"                \n                this.storeState.upError = null}\n              else {store.setUpError(\"Ceci n'est pas une photo de l'extérieur du restaurant\"),                    \n                    this.endpoint = false,\n                    store.setShowCatBut()}\n        } else if (this.upUrl == 5) {\n          if (this.storeState.labels.includes ('Restaurant')) {\n                this.endpoint = \"inside_pic\"                \n                this.storeState.upError = null}\n              else {store.setUpError(\"Ceci n'est pas une photo de l'interieur du restaurant\"),                    \n                    this.endpoint = false,\n                    store.setShowCatBut()}\n        } \n        \n        if (this.endpoint != false){\n          console.log(this.endpoint)\n          fd.append('picture_1', this.selectedFile)\n          fd.append('restaurant_review', this.id)\n          axios.post(`${vueconfig.baseUrl}/api/${this.endpoint}/`, fd, axiosConfig)\n            .then(res => {                                  \n              this.upUrl = null              \n              store.setShowCatBut()              \n              let newPictureUrl = res.data.picture_1\n              let newPictureId = res.data.id\n              let apiURL = res.config.url\n              let addPicDic = {\"url\": newPictureUrl,\n                              \"id\": newPictureId,\n                              \"apiUrl\": apiURL  }          \n              store.addPicture(addPicDic)                            \n          })\n        }\n      } \n    },\n    goHome() {\n      this.$router.push({name: 'home'})           \n    },\n    setUpUrl() {\n      this.upUrlArray.push(this.upex)\n      if (this.upUrlArray.length > 1 && this.upUrlArray.length % 2 == 0) {\n        this.upUrl = this.upUrlArray[this.upUrlArray.length - 2]\n        console.log(this.upUrl)\n        store.setShowCatBut()\n        this.storeState.upError = null\n      }\n    }   \n  }, \n  components: {\n    PictureUpload,\n    Resize\n    },\n  watch: {\n    \"storeState.labels\": function () {\n      this.onUpload()\n      } \n    } \n  }\n</script>\n\n<style>\n.editor {\n  background-color: white;\n  border: 1px solid \n}\n.custom-file-label {\n  background-color: rgb(234, 236, 122);\n}\n.btnRow {\n  background-color: white\n}\n.catBtn:hover {\n  background-color: #5cb85c;\n  color: white\n}\n</style>"]}]}